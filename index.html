<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Zo2y ‚Äî Discover Local Favorites</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <style>
        /* CRITICAL CSS - Loads first */
        :root { 
            --bg: #0b1633; 
            --card: #132347; 
            --muted: #8ca3c7; 
            --accent: #f59e0b; 
            --glass: rgba(255,255,255,0.03); 
            --white: #ffffff; 
            --border: rgba(255,255,255,0.1);
            --gradient: linear-gradient(135deg, #f59e0b 0%, #ffb84d 100%);
            --shadow: 0 10px 30px rgba(0,0,0,0.3);
            --success: #10b981; 
            --error: #ef4444; 
            --info: #3b82f6;
            --surface: rgba(19, 35, 71, 0.6);
            --cloud-color: #3b82f6;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html, body { height: 100%; font-family: 'Inter', system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--white); line-height: 1.6; overflow-x: hidden; }
        a { color: inherit; text-decoration: none; }
        img { display: block; max-width: 100%; height: auto; }
        
        /* Critical layout styles */
        header { 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            display: flex; 
            align-items: center; 
            gap: 20px; 
            padding: 14px 16px; 
            backdrop-filter: blur(10px) saturate(180%);
            background: var(--surface); 
            border-bottom: 1px solid var(--border); 
            justify-content: center;
        }
        
        .nav-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            max-width: 1200px;
        }
        
        .logo { 
            height: 40px; 
            cursor: pointer; 
            transition: transform 0.3s ease;
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .nav-btn {
            background: var(--card); 
            border: 1px solid var(--border); 
            color: var(--white); 
            padding: 8px 16px; 
            border-radius: 16px; 
            cursor: pointer; 
            font-size: 13px; 
            font-weight: 500; 
            transition: all 0.2s ease; 
            white-space: nowrap;
        }
        
        /* Guest Banner */
        .guest-banner {
            display: none;
            max-width: 800px;
            width: calc(100% - 32px);
            border-radius: 12px;
            margin: 16px auto 16px auto;
            border: 1px solid rgba(245, 158, 11, 0.2);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(255, 184, 77, 0.1) 100%);
            padding: 10px 16px;
            text-align: center;
        }
        
        .guest-banner.show {
            display: block;
        }
        
        .hero { 
            position: relative; 
            min-height: 60vh; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 32px 16px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .hero-container {
            display: flex;
            align-items: center;
            gap: 40px;
            width: 100%;
        }
        
        .hero-left {
            flex: 1;
            min-width: 0;
        }
        
        .container { 
            max-width: 1200px; 
            margin: 32px auto; 
            padding: 0 16px; 
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        /* Mobile-first carousel styles */
        .carousel-container {
            position: relative;
            margin: 0 -16px;
            padding: 0 16px 20px 16px;
        }
        
        .carousel-track {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            padding: 8px 0;
        }
        
        .carousel-track::-webkit-scrollbar {
            display: none;
        }
        
        .carousel-card {
            flex: 0 0 280px;
            scroll-snap-align: start;
        }
        
        /* Restaurant Cards - Mobile Optimized */
        .restaurant-card { 
            background: var(--card); 
            border-radius: 12px; 
            overflow: hidden; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
            border: 1px solid var(--border);
            cursor: pointer; 
            position: relative;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
        } 
        
        .restaurant-card:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 12px 24px rgba(0,0,0,0.2);
            border-color: var(--accent);
        }
        
        .card-image {
            height: 160px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #1a2d5f 0%, #0b1633 100%);
        }
        
        .restaurant-image {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .restaurant-image.loaded {
            opacity: 1;
        }
        
        .card-content {
            padding: 12px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .card-header {
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
        }
        
        .card-title {
            font-size: 14px;
            font-weight: 700;
            line-height: 1.3;
            margin: 0;
            flex: 1;
        }
        
        .card-rating {
            background: var(--gradient);
            color: #0b1633;
            padding: 3px 6px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 3px;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .card-category {
            color: var(--accent);
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .card-description {
            color: var(--muted);
            font-size: 12px;
            line-height: 1.4;
            margin: 0 0 12px 0;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex: 1;
        }
        
        /* Skeleton Loading */
        .skeleton-card { 
            background: var(--card); 
            border-radius: 12px; 
            overflow: hidden; 
            border: 1px solid var(--border); 
        }
        
        .skeleton-image { 
            height: 160px; 
            background: linear-gradient(90deg, var(--card) 25%, rgba(255,255,255,0.05) 50%, var(--card) 75%); 
            background-size: 200% 100%; 
            animation: loading 1.5s infinite; 
        }
        
        .skeleton-content { 
            padding: 12px; 
        }
        
        .skeleton-line { 
            height: 10px; 
            background: linear-gradient(90deg, var(--card) 25%, rgba(255,255,255,0.05) 50%, var(--card) 75%); 
            background-size: 200% 100%; 
            animation: loading 1.5s infinite; 
            margin-bottom: 6px; 
            border-radius: 3px; 
        }
        
        .skeleton-line.short { 
            width: 60%; 
        }
        
        @keyframes loading { 
            0% { background-position: 200% 0; } 
            100% { background-position: -200% 0; } 
        }
        
        /* Load More */
        .load-more-container { 
            display: flex; 
            justify-content: center; 
            margin-top: 20px; 
        }
        
        .load-more-btn { 
            background: var(--card); 
            border: 1px solid var(--border); 
            color: var(--white); 
            padding: 10px 24px; 
            border-radius: 12px; 
            font-weight: 500; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
        }
        
        /* Responsive breakpoints */
        @media (max-width: 768px) {
            .hero-container {
                flex-direction: column-reverse;
                gap: 32px;
                text-align: center;
            }
            
            .hero-left {
                text-align: center;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            
            .search-wrapper {
                display: none; /* Hide search on mobile for faster load */
            }
            
            .nav-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
        }
        
        @media (min-width: 769px) {
            /* Desktop Grid */
            .grid { 
                display: grid; 
                gap: 20px; 
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
            
            .restaurant-card { 
                border-radius: 16px; 
            }
            
            .card-image {
                height: 200px;
            }
            
            .card-content {
                padding: 16px;
            }
            
            .card-title {
                font-size: 16px;
            }
            
            .card-rating {
                padding: 4px 8px;
                font-size: 13px;
            }
            
            .card-category {
                font-size: 13px;
            }
            
            .card-description {
                font-size: 14px;
            }
            
            .skeleton-image { 
                height: 200px; 
            }
        }
        
        /* Defer non-critical styles */
        .non-critical {
            display: none;
        }
    </style>
    
    <link rel="icon" type="image/png" href="images/logo.png">
    
    <!-- Inline critical script for faster loading -->
    <script>
        // Critical: Prevent layout shift by setting initial styles
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial dimensions for skeleton cards
            const skeletons = document.querySelectorAll('.skeleton-card');
            skeletons.forEach(skeleton => {
                skeleton.style.minHeight = '280px';
            });
            
            // Load non-critical CSS
            setTimeout(function() {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = 'non-critical.css';
                document.head.appendChild(link);
            }, 100);
        });
        
        // Mobile detection for optimized loading
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // Optimize image loading for mobile
        if (isMobile) {
            // Load smaller images for mobile
            window.imageQuality = 'medium';
        } else {
            window.imageQuality = 'high';
        }
    </script>
</head>
<body>
    <!-- Guest Banner -->
    <div id="guestBanner" class="guest-banner">
        <div class="banner-content">
            <span class="banner-text">Want to save your favorite restaurants?</span>
            <div class="banner-actions">
                <button class="banner-btn banner-btn-outline" id="bannerLoginBtn">Sign In</button>
                <button class="banner-btn banner-btn-primary" id="bannerSignupBtn">Create Account</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="nav-container">
            <img src="images/logo.png" alt="Zo2y" class="logo" onclick="location.href='index.html'">
            
            <div class="search-wrapper" id="searchWrapper">
                <!-- Search will be added for desktop -->
            </div>
            
            <div class="nav-right">
                <button class="nav-btn" onclick="location.href='restraunts.html'">Explore All</button>
                <button class="nav-btn" id="authBtn">Sign In</button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-container">
            <div class="hero-left">
                <h1 id="heroTitle">Discover Local Favorites</h1>
                <p class="lead">Find authentic dining experiences based on real reviews.</p>
                <div class="cta-row">
                    <button class="hero-btn" id="startJourneyBtn">
                        <i class="fas fa-map-signs"></i>
                        <span>Start Your Food Journey</span>
                    </button>
                </div>
            </div>
            <div class="hero-right">
                <!-- Spotlight will be loaded dynamically -->
                <div class="skeleton-card" style="width: 100%; height: 300px;">
                    <div class="skeleton-image"></div>
                    <div class="skeleton-content">
                        <div class="skeleton-line" style="width: 70%"></div>
                        <div class="skeleton-line short"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Container -->
    <div class="container">
        <!-- Featured Restaurants -->
        <section class="section">
            <div class="section-header">
                <h2>Featured Restaurants</h2>
            </div>
            
            <div class="carousel-container">
                <div class="carousel-track" id="featuredCarousel">
                    <!-- Skeleton loading for mobile carousel -->
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                </div>
            </div>
            
            <div class="load-more-container">
                <button class="load-more-btn" onclick="location.href='restraunts.html'">
                    <i class="fas fa-arrow-right"></i>
                    View All Restaurants
                </button>
            </div>
        </section>

        <!-- Nearby Restaurants -->
        <section class="section">
            <div class="section-header">
                <h2>Nearby Restaurants</h2>
            </div>
            
            <div class="carousel-container">
                <div class="carousel-track" id="nearbyCarousel">
                    <!-- Skeleton loading for mobile carousel -->
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                    <div class="carousel-card"><div class="skeleton-card"><div class="skeleton-image"></div><div class="skeleton-content"><div class="skeleton-line" style="width: 70%"></div><div class="skeleton-line short"></div></div></div></div>
                </div>
            </div>
            
            <div class="load-more-container">
                <button class="load-more-btn" onclick="location.href='restraunts.html'">
                    <i class="fas fa-arrow-right"></i>
                    View All Restaurants
                </button>
            </div>
        </section>
    </div>

    <!-- Non-critical CSS (loaded after initial render) -->
    <style class="non-critical">
        /* Non-critical styles that can load after initial paint */
        .guest-banner {
            display: none;
            max-width: 800px;
            width: calc(100% - 40px);
            border-radius: 12px;
            margin: 20px auto 20px auto;
            border: 1px solid rgba(245, 158, 11, 0.2);
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(255, 184, 77, 0.1) 100%);
            padding: 10px 20px;
            text-align: center;
        }
        
        .guest-banner.show {
            display: block;
        }
        
        .banner-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            color: var(--muted);
            font-size: 14px;
        }
        
        .banner-text {
            margin-right: 8px;
            font-size: 13px;
        }
        
        .banner-actions {
            display: flex;
            gap: 6px;
            align-items: center;
        }
        
        .banner-btn {
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            white-space: nowrap;
        }
        
        .banner-btn-outline {
            background: transparent;
            color: var(--accent);
            border: 1px solid var(--accent);
        }
        
        .banner-btn-outline:hover {
            background: rgba(245, 158, 11, 0.1);
        }
        
        .banner-btn-primary {
            background: var(--accent);
            color: #111;
            border: 1px solid var(--accent);
        }
        
        .banner-btn-primary:hover {
            background: #ffb84d;
            transform: translateY(-1px);
        }
        
        /* Search */
        .search-wrapper {
            width: 320px;
            position: relative;
        }
        
        .search { 
            width: 100%; 
            padding: 10px 16px 10px 40px; 
            border-radius: 20px; 
            border: 1px solid var(--border); 
            background: var(--card); 
            color: var(--white); 
            outline: none; 
            font-size: 14px; 
            transition: all 0.3s ease;
        } 
        
        .search:focus { 
            border-color: var(--accent); 
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1); 
        } 
        
        .search-icon { 
            position: absolute; 
            left: 12px; 
            top: 50%; 
            transform: translateY(-50%); 
            opacity: 0.6; 
            pointer-events: none;
        }
        
        .clear-search {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--muted);
            cursor: pointer;
            display: none;
            padding: 4px;
        }
        
        .nav-btn:hover { 
            background: var(--accent); 
            color: #0b1633; 
        }
        
        .nav-btn-primary {
            background: var(--gradient);
            border: none;
            color: #0b1633;
            font-weight: 600;
        }
        
        .ghost-btn {
            background: transparent;
            color: var(--muted);
            padding: 8px 16px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .ghost-btn:hover {
            color: var(--accent);
            background: rgba(245, 158, 11, 0.05);
        }
        
        .tag { 
            display: inline-flex; 
            align-items: center; 
            justify-content: center; 
            gap: 8px; 
            color: var(--accent); 
            font-weight: 600; 
            font-size: 13px; 
            padding: 6px 12px; 
            border-radius: 999px; 
            margin-bottom: 16px; 
            border: 1px solid rgba(245, 158, 11, 0.2); 
            background: rgba(245, 158, 11, 0.05); 
        }
        
        .lead { 
            color: var(--muted); 
            font-size: clamp(0.875rem, 2vw, 1rem); 
            margin-bottom: 24px; 
            max-width: 500px; 
            line-height: 1.6; 
            font-weight: 400; 
        }
        
        .cta-row { 
            display: flex; 
            gap: 12px; 
            align-items: center; 
            flex-wrap: wrap; 
        }
        
        .hero-btn { 
            background: var(--gradient); 
            color: #0b1633; 
            padding: 12px 24px; 
            border-radius: 12px; 
            font-weight: 700; 
            border: none; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            font-size: 14px; 
            transition: all 0.3s ease; 
            position: relative; 
            overflow: hidden; 
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.3); 
        }
        
        .hero-btn:hover { 
            transform: translateY(-2px) scale(1.03); 
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4); 
        }
        
        .hero-btn-outline { 
            background: transparent; 
            color: var(--white); 
            padding: 12px 24px; 
            border-radius: 12px; 
            border: 1px solid var(--border); 
            font-weight: 500; 
            transition: all 0.3s ease; 
            font-size: 14px; 
        }
        
        .hero-btn-outline:hover { 
            border-color: var(--accent); 
            background: rgba(245, 158, 11, 0.05); 
        }
        
        /* Spotlight */
        .spotlight-wrapper { 
            width: 100%; 
            position: relative; 
        }
        
        .spotlight { 
            width: 100%; 
            border-radius: 16px; 
            overflow: hidden; 
            background: var(--card); 
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3); 
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            transition: all 0.2s ease;
            cursor: pointer;
            height: 400px;
        }
        
        .spotlight:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 12px 24px rgba(0,0,0,0.2);
            border-color: var(--accent);
        }
        
        .slide-indicators { 
            display: flex; 
            justify-content: center; 
            gap: 8px; 
            margin-top: 16px; 
        }
        
        .slide-indicator { 
            width: 10px; 
            height: 10px; 
            border-radius: 50%; 
            background: var(--border); 
            cursor: pointer; 
            transition: all 0.3s ease; 
        }
        
        .slide-indicator.active { 
            background: var(--accent); 
            transform: scale(1.2); 
        }
        
        .slide-indicator:hover { 
            background: var(--accent); 
        }
        
        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .section h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
            margin: 0;
            color: var(--white);
            font-weight: 600;
        }
        
        .section-subtitle {
            color: var(--muted);
            font-size: 14px;
            margin-top: 4px;
            max-width: 500px;
            line-height: 1.5;
        }
        
        .view-all {
            color: var(--accent);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            font-size: 14px;
            white-space: nowrap;
        }
        
        /* Restaurant Cards Enhancements */
        .list-badges-container {
            position: absolute;
            top: 8px;
            left: 8px;
            display: flex;
            gap: 4px;
            z-index: 30;
            align-items: flex-start;
            flex-direction: column;
        }
        
        .list-badge {
            background: rgba(11, 22, 51, 0.95);
            color: var(--accent);
            padding: 6px 8px;
            border-radius: 6px;
            font-size: 14px;
            border: 1px solid var(--accent);
            cursor: help;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
        }
        
        .list-badge:hover {
            transform: scale(1.1);
            background: rgba(245, 158, 11, 0.95);
            color: #0b1633;
        }
        
        /* Cloud Kitchen Badge */
        .cloud-badge {
            position: absolute;
            top: 8px;
            right: 48px;
            width: 32px;
            height: 32px;
            background: rgba(59, 130, 246, 0.95);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: help;
            z-index: 100;
            transition: all 0.3s ease;
            border: 1px solid var(--cloud-color);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            color: white;
            font-size: 16px;
        }
        
        .cloud-badge:hover {
            background: rgba(59, 130, 246, 1);
            transform: scale(1.05);
        }
        
        /* Menu button */
        .menu-btn-container {
            position: absolute;
            top: 8px;
            right: 8px;
            z-index: 30;
        }
        
        .menu-btn {
            width: 32px;
            height: 32px;
            background: rgba(11, 22, 51, 0.9);
            border: 1px solid var(--accent);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .menu-btn:hover {
            background: var(--accent);
            transform: scale(1.1);
        }
        
        .menu-btn i {
            color: var(--white);
            font-size: 14px;
        }
        
        .menu-btn:hover i {
            color: #0b1633;
        }
        
        /* Logo overlay */
        .logo-overlay {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 40px;
            height: 40px;
            background: rgba(11, 22, 51, 0.9);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 3px;
            border: 2px solid var(--accent);
            backdrop-filter: none;
            z-index: 20;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
            pointer-events: none;
        }
        
        .logo-overlay img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 6px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .logo-overlay img.loaded {
            opacity: 1;
        }
        
        .restaurant-card:hover .logo-overlay {
            transform: scale(1.1);
            border-color: var(--accent);
            background: rgba(245,158,11,0.9);
            box-shadow: 0 8px 24px rgba(245,158,11,0.4);
        }
        
        .top-rated-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f59e0b 0%, #ffb84d 100%);
            color: #0b1633;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 9px;
            font-weight: 800;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            border: 1px solid rgba(245, 158, 11, 0.5);
            animation: glow 2s infinite alternate;
            box-shadow: 0 0 10px rgba(245, 158, 11, 0.3);
            white-space: nowrap;
        }
        
        @keyframes glow {
            0% {
                box-shadow: 0 0 5px rgba(245, 158, 11, 0.5),
                            0 0 10px rgba(245, 158, 11, 0.3);
            }
            100% {
                box-shadow: 0 0 10px rgba(245, 158, 11, 0.8),
                            0 0 20px rgba(245, 158, 11, 0.5),
                            0 0 30px rgba(245, 158, 11, 0.3);
            }
        }
        
        /* Desktop-only styles */
        @media (min-width: 769px) {
            .carousel-container {
                display: none;
            }
            
            .grid-container {
                display: block;
            }
            
            /* Show search on desktop */
            .search-wrapper {
                display: block;
            }
            
            /* Desktop card enhancements */
            .list-badges-container {
                top: 12px;
                left: 12px;
                gap: 6px;
            }
            
            .list-badge {
                padding: 8px 10px;
                font-size: 18px;
                width: 40px;
                height: 40px;
            }
            
            .cloud-badge {
                top: 12px;
                right: 56px;
                width: 40px;
                height: 40px;
                font-size: 20px;
            }
            
            .menu-btn {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .logo-overlay {
                width: 48px;
                height: 48px;
                bottom: 12px;
                right: 12px;
            }
            
            .top-rated-badge {
                padding: 3px 8px;
                font-size: 10px;
            }
        }
        
        @media (max-width: 768px) {
            .grid-container {
                display: none;
            }
            
            .carousel-container {
                display: block;
            }
        }
    </style>
</body>

<!-- Optimized JavaScript loaded at end -->
<script>
// Mobile-optimized script for faster loading
(function() {
    'use strict';
    
    // ---------- CONFIG ----------
    const SUPABASE_URL = 'https://gfkhjbztayjyojsgdpgk.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdma2hqYnp0YXlqeW9qc2dkcGdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwOTYyNjQsImV4cCI6MjA3NTY3MjI2NH0.WUb2yDAwCeokdpWCPeH13FE8NhWF6G8e6ivTsgu6b2s';
    
    // Mobile detection
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    // Optimize for mobile
    const MOBILE_OPTIMIZATIONS = {
        loadLimit: isMobile ? 8 : 16, // Load fewer items on mobile
        imageQuality: isMobile ? 'medium' : 'high',
        lazyLoadImages: true,
        debounceDelay: isMobile ? 300 : 100
    };
    
    // Initialize Supabase (deferred)
    let supabase;
    
    // Simple state management
    const state = {
        restaurants: [],
        isLoggedIn: false,
        currentUser: null,
        imageObserver: null
    };
    
    // ---------- OPTIMIZED IMAGE LOADING ----------
    function initOptimizedImageLoader() {
        if (state.imageObserver) return;
        
        // Use IntersectionObserver only if supported
        if ('IntersectionObserver' in window) {
            state.imageObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        if (img.dataset.src) {
                            // Load optimized image based on device
                            const originalSrc = img.dataset.src;
                            let optimizedSrc = originalSrc;
                            
                            // For mobile, we could add image optimization parameters here
                            if (isMobile && originalSrc.includes('supabase.co')) {
                                // Add Supabase image optimization parameters for mobile
                                optimizedSrc = originalSrc + '?width=300&quality=80';
                            }
                            
                            img.src = optimizedSrc;
                            img.classList.add('loaded');
                            state.imageObserver.unobserve(img);
                        }
                    }
                });
            }, {
                rootMargin: '50px 0px',
                threshold: 0.01
            });
        } else {
            // Fallback: Load all images immediately
            setTimeout(loadAllImages, 1000);
        }
    }
    
    function loadAllImages() {
        const images = document.querySelectorAll('img[data-src]');
        images.forEach(img => {
            if (img.dataset.src) {
                img.src = img.dataset.src;
                img.onload = () => img.classList.add('loaded');
            }
        });
    }
    
    // ---------- MOBILE CAROUSEL FUNCTIONS ----------
    function createMobileCarousel(containerId, restaurants) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        // Clear skeleton loading
        container.innerHTML = '';
        
        // Add cards to carousel
        const fragment = document.createDocumentFragment();
        
        // Limit cards for mobile performance
        const cardsToShow = isMobile ? Math.min(6, restaurants.length) : restaurants.length;
        
        for (let i = 0; i < cardsToShow; i++) {
            const restaurant = restaurants[i];
            if (!restaurant) break;
            
            const cardElement = createMobileCard(restaurant);
            const cardWrapper = document.createElement('div');
            cardWrapper.className = 'carousel-card';
            cardWrapper.appendChild(cardElement);
            fragment.appendChild(cardWrapper);
        }
        
        container.appendChild(fragment);
        
        // Initialize lazy loading for images
        if (state.imageObserver) {
            setTimeout(() => {
                const images = container.querySelectorAll('img[data-src]');
                images.forEach(img => {
                    if (!img.classList.contains('observed')) {
                        state.imageObserver.observe(img);
                        img.classList.add('observed');
                    }
                });
            }, 100);
        }
    }
    
    function createMobileCard(restaurant) {
        const card = document.createElement('div');
        card.className = 'restaurant-card';
        card.dataset.id = restaurant.id;
        
        const rating = restaurant.rating || 0;
        const category = restaurant.category || 'Restaurant';
        const hasCoverImage = restaurant.coverImage && restaurant.coverImage !== '';
        
        // Simple mobile-optimized card HTML
        card.innerHTML = `
            <a href="restaurant.html?slug=${restaurant.slug}" class="card-link">
                <div class="card-image">
                    ${hasCoverImage ? `
                        <img class="restaurant-image" 
                             data-src="${restaurant.coverImage}" 
                             alt="${restaurant.name}" 
                             width="280" 
                             height="160">
                    ` : ''}
                </div>
                <div class="card-content">
                    <div class="card-header">
                        <h3 class="card-title">${restaurant.name}</h3>
                        <div class="card-rating">
                            <i class="fas fa-star"></i>
                            ${rating.toFixed(1)}
                        </div>
                    </div>
                    <div class="card-category">
                        <span>üç¥</span>
                        ${category}
                    </div>
                    <p class="card-description">${restaurant.description || 'Delicious food served with care'}</p>
                </div>
            </a>
        `;
        
        return card;
    }
    
    // ---------- DESKTOP GRID FUNCTIONS ----------
    function createDesktopGrid(containerId, restaurants) {
        const container = document.getElementById(containerId);
        if (!container) return;
        
        // Convert container to grid
        container.className = 'grid';
        container.innerHTML = '';
        
        const fragment = document.createDocumentFragment();
        
        // Limit cards for performance
        const cardsToShow = Math.min(8, restaurants.length);
        
        for (let i = 0; i < cardsToShow; i++) {
            const restaurant = restaurants[i];
            if (!restaurant) break;
            
            const cardElement = createDesktopCard(restaurant);
            fragment.appendChild(cardElement);
        }
        
        container.appendChild(fragment);
        
        // Initialize lazy loading
        if (state.imageObserver) {
            setTimeout(() => {
                const images = container.querySelectorAll('img[data-src]');
                images.forEach(img => {
                    if (!img.classList.contains('observed')) {
                        state.imageObserver.observe(img);
                        img.classList.add('observed');
                    }
                });
            }, 100);
        }
    }
    
    function createDesktopCard(restaurant) {
        // Similar to mobile but with more features
        return createMobileCard(restaurant);
    }
    
    // ---------- DATA LOADING WITH PRIORITIZATION ----------
    async function loadEssentialData() {
        try {
            // Initialize Supabase
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            
            // Load restaurants first (most important)
            const { data, error } = await supabase
                .from('restraunts')
                .select('id, slug, name, category, description, rating, image')
                .order('rating', { ascending: false })
                .limit(MOBILE_OPTIMIZATIONS.loadLimit);
            
            if (error) throw error;
            
            if (data && data.length > 0) {
                state.restaurants = data.map(r => ({
                    ...r,
                    coverImage: r.image
                }));
                
                // Render immediately
                if (isMobile) {
                    createMobileCarousel('featuredCarousel', state.restaurants.slice(0, 4));
                    createMobileCarousel('nearbyCarousel', state.restaurants.slice(4, 8));
                } else {
                    createDesktopGrid('featuredCarousel', state.restaurants.slice(0, 8));
                    // For desktop, we need to create grid containers
                    document.getElementById('featuredCarousel').id = 'featuredGrid';
                    document.getElementById('nearbyCarousel').style.display = 'none';
                }
                
                // Load auth status in background
                setTimeout(loadAuthStatus, 500);
            }
            
        } catch (error) {
            console.error('Error loading data:', error);
        }
    }
    
    async function loadAuthStatus() {
        try {
            const { data: { session } } = await supabase.auth.getSession();
            state.isLoggedIn = !!session;
            state.currentUser = session?.user || null;
            
            updateAuthUI();
            
        } catch (error) {
            console.error('Error loading auth:', error);
        }
    }
    
    function updateAuthUI() {
        const authBtn = document.getElementById('authBtn');
        const guestBanner = document.getElementById('guestBanner');
        
        if (!authBtn) return;
        
        if (state.isLoggedIn && state.currentUser) {
            // User is logged in
            const name = state.currentUser.email?.split('@')[0] || 'Account';
            authBtn.innerHTML = `<i class="fas fa-user"></i><span>${name}</span>`;
            authBtn.onclick = () => location.href = 'profile.html';
            
            if (guestBanner) {
                guestBanner.style.display = 'none';
            }
        } else {
            // User is not logged in
            authBtn.innerHTML = `<i class="fas fa-sign-in-alt"></i><span>Sign In</span>`;
            authBtn.onclick = () => location.href = 'login.html';
            
            if (guestBanner) {
                guestBanner.classList.add('show');
            }
        }
    }
    
    // ---------- EVENT HANDLERS ----------
    function setupEventListeners() {
        // Banner buttons
        const bannerLoginBtn = document.getElementById('bannerLoginBtn');
        const bannerSignupBtn = document.getElementById('bannerSignupBtn');
        
        if (bannerLoginBtn) {
            bannerLoginBtn.addEventListener('click', () => {
                location.href = 'login.html';
            });
        }
        
        if (bannerSignupBtn) {
            bannerSignupBtn.addEventListener('click', () => {
                location.href = 'sign-up.html';
            });
        }
        
        // Start journey button
        const startJourneyBtn = document.getElementById('startJourneyBtn');
        if (startJourneyBtn) {
            startJourneyBtn.addEventListener('click', () => {
                if (state.isLoggedIn) {
                    location.href = 'restraunts.html';
                } else {
                    location.href = 'sign-up.html';
                }
            });
        }
        
        // Add search functionality for desktop
        if (!isMobile) {
            setTimeout(() => {
                const searchWrapper = document.getElementById('searchWrapper');
                if (searchWrapper) {
                    searchWrapper.innerHTML = `
                        <div class="search-wrapper">
                            <span class="search-icon">üîé</span>
                            <input type="text" id="search" class="search" placeholder="Search restaurants...">
                            <button class="clear-search" id="clearSearch">‚úï</button>
                        </div>
                    `;
                    
                    const searchInput = document.getElementById('search');
                    const clearSearch = document.getElementById('clearSearch');
                    
                    if (searchInput && clearSearch) {
                        searchInput.addEventListener('input', () => {
                            clearSearch.style.display = searchInput.value ? 'block' : 'none';
                        });
                        
                        searchInput.addEventListener('keypress', (e) => {
                            if (e.key === 'Enter') {
                                const term = searchInput.value.trim();
                                if (term) {
                                    location.href = `restraunts.html?search=${encodeURIComponent(term)}`;
                                }
                            }
                        });
                        
                        clearSearch.addEventListener('click', () => {
                            searchInput.value = '';
                            clearSearch.style.display = 'none';
                        });
                    }
                }
            }, 1000);
        }
    }
    
    // ---------- INITIALIZATION ----------
    function init() {
        // Initialize image loader
        initOptimizedImageLoader();
        
        // Setup event listeners
        setupEventListeners();
        
        // Load essential data
        loadEssentialData();
        
        // Load non-essential features after a delay
        setTimeout(() => {
            // Add hero spotlight if on desktop
            if (!isMobile) {
                loadSpotlightFeature();
            }
            
            // Load more detailed restaurant data
            loadAdditionalRestaurantData();
        }, 2000);
    }
    
    async function loadSpotlightFeature() {
        // This loads the spotlight feature for desktop
        try {
            const { data } = await supabase
                .from('restraunts')
                .select('slug, name, description, rating, image')
                .order('rating', { ascending: false })
                .limit(1)
                .single();
            
            if (data) {
                const heroRight = document.querySelector('.hero-right');
                if (heroRight) {
                    heroRight.innerHTML = `
                        <div class="spotlight-wrapper">
                            <div class="spotlight" onclick="location.href='restaurant.html?slug=${data.slug}'">
                                <div class="card-image">
                                    ${data.image ? `
                                        <img class="restaurant-image" 
                                             data-src="${data.image}" 
                                             alt="${data.name}" 
                                             width="500" 
                                             height="300">
                                    ` : ''}
                                </div>
                                <div class="card-content">
                                    <div class="card-header">
                                        <h3 class="card-title">${data.name}</h3>
                                        <div class="card-rating">
                                            <i class="fas fa-star"></i>
                                            ${(data.rating || 0).toFixed(1)}
                                        </div>
                                    </div>
                                    <p class="card-description">${data.description || 'Featured restaurant'}</p>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // Load the image
                    const img = heroRight.querySelector('img[data-src]');
                    if (img && img.dataset.src) {
                        img.src = img.dataset.src;
                        img.onload = () => img.classList.add('loaded');
                    }
                }
            }
        } catch (error) {
            console.error('Error loading spotlight:', error);
        }
    }
    
    async function loadAdditionalRestaurantData() {
        // Load additional data in the background
        try {
            // Load more restaurants for better UX
            const { data } = await supabase
                .from('restraunts')
                .select('logo_url')
                .limit(20);
            
            // We could use this data to enhance cards, but for now just cache it
            console.log('Additional restaurant data loaded:', data?.length || 0);
        } catch (error) {
            console.error('Error loading additional data:', error);
        }
    }
    
    // Start initialization
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>
</html>
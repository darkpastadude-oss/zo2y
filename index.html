<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zo2y Universe</title>
    <meta name="description" content="Universal media homepage for restaurants, movies, TV, games, and books." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --bg: #061028;
            --bg-soft: #0c1a3d;
            --card: #10214a;
            --card-soft: #13295d;
            --text: #f2f6ff;
            --muted: #9eb0d8;
            --accent: #7dd3fc;
            --accent-2: #f59e0b;
            --border: rgba(158, 176, 216, 0.22);
            --ok: #34d399;
            --radius-lg: 18px;
            --radius-md: 12px;
            --shadow: 0 14px 40px rgba(0, 0, 0, 0.28);
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            font-family: "IBM Plex Sans", sans-serif;
            color: var(--text);
            background:
                radial-gradient(circle at 12% 0%, #12306e 0%, transparent 36%),
                radial-gradient(circle at 88% 10%, #5b2b7f 0%, transparent 30%),
                linear-gradient(180deg, #07112a 0%, #050c1f 100%);
            min-height: 100vh;
        }

        a { color: inherit; text-decoration: none; }

        .shell {
            width: min(1200px, calc(100% - 32px));
            margin: 0 auto;
            padding: 16px 0 48px;
        }

        .topbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 18px;
            padding: 12px 14px;
            background: rgba(16, 33, 74, 0.72);
            border: 1px solid var(--border);
            border-radius: 14px;
            backdrop-filter: blur(10px);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: "Space Grotesk", sans-serif;
            font-size: 22px;
            font-weight: 700;
            letter-spacing: 0.4px;
        }

        .brand-mark {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            display: grid;
            place-items: center;
            background: linear-gradient(135deg, #7dd3fc, #f59e0b);
            color: #08132f;
            font-size: 15px;
        }

        .topbar-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .btn {
            border: 1px solid var(--border);
            background: #10214a;
            color: var(--text);
            border-radius: 10px;
            padding: 10px 14px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
        }

        .btn:hover { border-color: var(--accent); }

        .btn.primary {
            background: linear-gradient(135deg, #7dd3fc, #38bdf8);
            color: #04142f;
            border-color: transparent;
        }

        .hero {
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            background:
                radial-gradient(circle at 8% 8%, rgba(125, 211, 252, 0.3), transparent 35%),
                radial-gradient(circle at 90% 30%, rgba(245, 158, 11, 0.28), transparent 32%),
                linear-gradient(150deg, #10214a, #0b1a3e);
            box-shadow: var(--shadow);
            padding: 22px;
            margin-bottom: 18px;
        }

        .hero h1 {
            margin: 0;
            font-family: "Space Grotesk", sans-serif;
            font-size: clamp(28px, 4vw, 44px);
            line-height: 1.1;
        }

        .hero p {
            margin: 10px 0 14px;
            color: #d2ddf8;
            max-width: 760px;
            font-size: 16px;
        }

        .media-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 7px;
            border-radius: 999px;
            padding: 8px 12px;
            border: 1px solid rgba(226, 232, 240, 0.26);
            background: rgba(4, 10, 26, 0.38);
            font-size: 13px;
            color: #ebf2ff;
        }

        .quick-grid {
            margin: 16px 0 20px;
            display: grid;
            grid-template-columns: repeat(5, minmax(0, 1fr));
            gap: 10px;
        }

        .quick-card {
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: linear-gradient(160deg, #13295d, #0e204a);
            padding: 13px;
            transition: transform 0.2s ease;
        }

        .quick-card:hover { transform: translateY(-3px); }

        .quick-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            margin-bottom: 6px;
            font-family: "Space Grotesk", sans-serif;
        }

        .quick-card p {
            margin: 0;
            color: var(--muted);
            font-size: 13px;
            min-height: 36px;
        }

        .section {
            margin-top: 22px;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            background: rgba(10, 23, 52, 0.8);
            overflow: hidden;
        }

        .section-head {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
        }

        .section-title {
            margin: 0;
            font-family: "Space Grotesk", sans-serif;
            font-size: 22px;
        }

        .section-note {
            margin: 3px 0 0;
            color: var(--muted);
            font-size: 13px;
        }

        .link-btn {
            font-size: 13px;
            color: var(--accent);
            font-weight: 600;
        }

        .rail-wrap {
            padding: 14px;
        }

        .rail-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 0 0 10px;
            font-size: 15px;
            font-weight: 700;
        }

        .rail {
            display: grid;
            grid-auto-flow: column;
            grid-auto-columns: minmax(152px, 152px);
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 6px;
            scroll-snap-type: x mandatory;
        }

        .rail::-webkit-scrollbar { height: 8px; }
        .rail::-webkit-scrollbar-thumb {
            border-radius: 999px;
            background: rgba(125, 211, 252, 0.35);
        }

        .card {
            scroll-snap-align: start;
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            background: #0e2048;
            min-height: 228px;
        }

        .card-media {
            width: 100%;
            aspect-ratio: 2/3;
            background: #0a1838;
            display: grid;
            place-items: center;
            color: #b9c8ea;
        }

        .card-media.landscape { aspect-ratio: 16/10; }

        .card-media img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-meta {
            padding: 9px;
        }

        .card-name {
            margin: 0;
            font-size: 13px;
            font-weight: 600;
            line-height: 1.35;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            min-height: 36px;
        }

        .card-sub {
            margin: 5px 0 0;
            color: var(--muted);
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .empty {
            border: 1px dashed var(--border);
            border-radius: 12px;
            color: var(--muted);
            text-align: center;
            padding: 28px 12px;
            font-size: 13px;
            background: rgba(10, 20, 45, 0.65);
        }

        .status {
            margin-top: 10px;
            font-size: 13px;
            color: var(--ok);
        }

        @media (max-width: 1040px) {
            .quick-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }

        @media (max-width: 780px) {
            .shell { width: calc(100% - 18px); }
            .topbar { padding: 10px; }
            .brand { font-size: 18px; }
            .topbar-actions { width: 100%; justify-content: flex-start; }
            .btn { padding: 9px 11px; font-size: 13px; }
            .hero { padding: 16px; }
            .hero p { font-size: 14px; }
            .quick-grid { grid-template-columns: 1fr 1fr; }
            .rail { grid-auto-columns: minmax(136px, 136px); }
            .section-title { font-size: 18px; }
        }
    </style>
</head>
<body>
    <main class="shell">
        <header class="topbar">
            <a href="index.html" class="brand">
                <span class="brand-mark"><i class="fa-solid fa-globe"></i></span>
                <span>ZO2Y Universe</span>
            </a>
            <div class="topbar-actions">
                <a class="btn" href="profile.html" id="profileBtn">Profile</a>
                <a class="btn" href="login.html" id="loginBtn">Login</a>
                <a class="btn primary" href="sign-up.html" id="signupBtn">Sign Up</a>
            </div>
        </header>

        <section class="hero">
            <h1>One Home For Every Taste</h1>
            <p>Browse trending picks across restaurants, movies, TV shows, games, and books. Save what matters and jump straight into each media space from one universal homepage.</p>
            <div class="media-pills">
                <span class="pill"><i class="fa-solid fa-utensils"></i> Restaurants</span>
                <span class="pill"><i class="fa-solid fa-film"></i> Movies</span>
                <span class="pill"><i class="fa-solid fa-tv"></i> TV Shows</span>
                <span class="pill"><i class="fa-solid fa-gamepad"></i> Games</span>
                <span class="pill"><i class="fa-solid fa-book"></i> Books</span>
            </div>
            <div class="status" id="loadStatus">Loading universal feed...</div>
        </section>

        <section class="quick-grid">
            <a class="quick-card" href="restraunts.html">
                <div class="quick-top"><span>Restaurants</span><i class="fa-solid fa-arrow-right"></i></div>
                <p>Find local spots and community favorites.</p>
            </a>
            <a class="quick-card" href="movies.html">
                <div class="quick-top"><span>Movies</span><i class="fa-solid fa-arrow-right"></i></div>
                <p>Track must-watch films and personal picks.</p>
            </a>
            <a class="quick-card" href="tvshows.html">
                <div class="quick-top"><span>TV Shows</span><i class="fa-solid fa-arrow-right"></i></div>
                <p>Discover new series and binge lists.</p>
            </a>
            <a class="quick-card" href="games.html">
                <div class="quick-top"><span>Games</span><i class="fa-solid fa-arrow-right"></i></div>
                <p>Explore top releases and hidden gems.</p>
            </a>
            <a class="quick-card" href="books.html">
                <div class="quick-top"><span>Books</span><i class="fa-solid fa-arrow-right"></i></div>
                <p>Build reading lists from trending titles.</p>
            </a>
        </section>

        <section class="section">
            <div class="section-head">
                <div>
                    <h2 class="section-title">Live Universal Picks</h2>
                    <p class="section-note">Each row is swipeable on mobile and horizontal-scroll on desktop.</p>
                </div>
            </div>

            <div class="rail-wrap">
                <div class="rail-title"><span><i class="fa-solid fa-utensils"></i> Restaurants</span><a class="link-btn" href="restraunts.html">View all</a></div>
                <div class="rail" id="restaurantsRail"></div>
            </div>

            <div class="rail-wrap">
                <div class="rail-title"><span><i class="fa-solid fa-film"></i> Movies</span><a class="link-btn" href="movies.html">View all</a></div>
                <div class="rail" id="moviesRail"></div>
            </div>

            <div class="rail-wrap">
                <div class="rail-title"><span><i class="fa-solid fa-tv"></i> TV Shows</span><a class="link-btn" href="tvshows.html">View all</a></div>
                <div class="rail" id="tvRail"></div>
            </div>

            <div class="rail-wrap">
                <div class="rail-title"><span><i class="fa-solid fa-gamepad"></i> Games</span><a class="link-btn" href="games.html">View all</a></div>
                <div class="rail" id="gamesRail"></div>
            </div>

            <div class="rail-wrap">
                <div class="rail-title"><span><i class="fa-solid fa-book"></i> Books</span><a class="link-btn" href="books.html">View all</a></div>
                <div class="rail" id="booksRail"></div>
            </div>
        </section>
    </main>

    <script>
        const SUPABASE_URL = 'https://gfkhjbztayjyojsgdpgk.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdma2hqYnp0YXlqeW9qc2dkcGdrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwOTYyNjQsImV4cCI6MjA3NTY3MjI2NH0.WUb2yDAwCeokdpWCPeH13FE8NhWF6G8e6ivTsgu6b2s';
        const TMDB_TOKEN = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI4NzVjMDM5N2IxZGUxYzU3NjQ4ZmRiNjJiZGQ5NmI0OSIsIm5iZiI6MTc3MDU4Mzk1NC42NTc5OTk4LCJzdWIiOiI2OTg4Zjc5MmFlYTFkN2NjNjcyY2VlNDciLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.1RMWLft0Yl73gfhkCXtnqBIzRQHdaoLfZFYXYN7jm7s';
        const RAWG_KEY = '83b2a55ac54c4c1db7099212e740f680';
        const GOOGLE_BOOKS_KEY = 'AIzaSyD6EFAseKNOjzkpEaY1fmJmZnleM9uJP8s';

        const TMDB_POSTER = 'https://image.tmdb.org/t/p/w500';
        const statusEl = document.getElementById('loadStatus');

        function escapeHtml(value) {
            return String(value || '')
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        function setStatus(text, isError) {
            statusEl.textContent = text;
            statusEl.style.color = isError ? '#fca5a5' : 'var(--ok)';
        }

        function renderRail(railId, items, opts) {
            const rail = document.getElementById(railId);
            if (!rail) return;

            if (!items || !items.length) {
                rail.innerHTML = '<div class="empty">Nothing to show right now.</div>';
                return;
            }

            const isLandscape = !!opts.landscape;
            rail.innerHTML = items.map(item => {
                const title = escapeHtml(item.title);
                const subtitle = escapeHtml(item.subtitle);
                const href = item.href || '#';
                const img = item.image || '';
                return `
                    <a class="card" href="${href}">
                        <div class="card-media ${isLandscape ? 'landscape' : ''}">
                            ${img ? `<img src="${img}" alt="${title}" loading="lazy" />` : '<i class="fa-solid fa-image"></i>'}
                        </div>
                        <div class="card-meta">
                            <p class="card-name">${title}</p>
                            <p class="card-sub">${subtitle}</p>
                        </div>
                    </a>
                `;
            }).join('');
        }

        async function initAuthUi() {
            if (!window.supabase || !window.supabase.createClient) return;
            const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');
            const profileBtn = document.getElementById('profileBtn');

            try {
                const { data } = await client.auth.getSession();
                const isLoggedIn = !!data?.session?.user;
                if (isLoggedIn) {
                    loginBtn.style.display = 'none';
                    signupBtn.textContent = 'Open Profile';
                    signupBtn.href = 'profile.html';
                    profileBtn.style.display = 'inline-flex';
                } else {
                    profileBtn.style.display = 'none';
                }
            } catch (_err) {
                profileBtn.style.display = 'none';
            }
        }

        async function loadRestaurants() {
            if (!window.supabase || !window.supabase.createClient) return [];
            const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            const { data, error } = await client
                .from('restraunts')
                .select('id,name,image,category,rating')
                .order('rating', { ascending: false })
                .limit(10);

            if (error || !data) return [];

            return data.map(r => ({
                title: r.name || 'Restaurant',
                subtitle: `${r.category || 'Restaurant'}${r.rating ? ` | ${r.rating}/5` : ''}`,
                image: r.image ? `images/${r.image}` : '',
                href: r.id ? `restaurant.html?id=${encodeURIComponent(r.id)}` : 'restraunts.html'
            }));
        }

        async function loadMovies() {
            const res = await fetch('https://api.themoviedb.org/3/trending/movie/week?language=en-US', {
                headers: { Authorization: `Bearer ${TMDB_TOKEN}` }
            });
            if (!res.ok) return [];
            const json = await res.json();
            const results = Array.isArray(json.results) ? json.results.slice(0, 10) : [];
            return results.map(m => ({
                title: m.title || 'Movie',
                subtitle: m.release_date ? m.release_date.slice(0, 4) : 'Movie',
                image: m.poster_path ? `${TMDB_POSTER}${m.poster_path}` : '',
                href: m.id ? `movie.html?id=${encodeURIComponent(m.id)}` : 'movies.html'
            }));
        }

        async function loadTv() {
            const res = await fetch('https://api.themoviedb.org/3/trending/tv/week?language=en-US', {
                headers: { Authorization: `Bearer ${TMDB_TOKEN}` }
            });
            if (!res.ok) return [];
            const json = await res.json();
            const results = Array.isArray(json.results) ? json.results.slice(0, 10) : [];
            return results.map(t => ({
                title: t.name || 'TV Show',
                subtitle: t.first_air_date ? t.first_air_date.slice(0, 4) : 'TV Show',
                image: t.poster_path ? `${TMDB_POSTER}${t.poster_path}` : '',
                href: t.id ? `tvshow.html?id=${encodeURIComponent(t.id)}` : 'tvshows.html'
            }));
        }

        async function loadGames() {
            const res = await fetch(`https://api.rawg.io/api/games?page_size=10&ordering=-rating&key=${RAWG_KEY}`);
            if (!res.ok) return [];
            const json = await res.json();
            const results = Array.isArray(json.results) ? json.results : [];
            return results.map(g => ({
                title: g.name || 'Game',
                subtitle: g.released ? g.released.slice(0, 4) : 'Game',
                image: g.background_image || '',
                href: g.id ? `game.html?id=${encodeURIComponent(g.id)}` : 'games.html'
            }));
        }

        async function loadBooks() {
            const query = encodeURIComponent('popular fiction');
            const url = `https://www.googleapis.com/books/v1/volumes?q=${query}&orderBy=relevance&maxResults=10&key=${GOOGLE_BOOKS_KEY}`;
            const res = await fetch(url);
            if (!res.ok) return [];
            const json = await res.json();
            const items = Array.isArray(json.items) ? json.items : [];
            return items.map(item => {
                const info = item.volumeInfo || {};
                const image = info.imageLinks?.thumbnail || info.imageLinks?.smallThumbnail || '';
                const author = Array.isArray(info.authors) && info.authors.length ? info.authors[0] : 'Book';
                return {
                    title: info.title || 'Book',
                    subtitle: author,
                    image,
                    href: item.id ? `book.html?id=${encodeURIComponent(item.id)}` : 'books.html'
                };
            });
        }

        async function initUniversalHome() {
            setStatus('Loading universal feed...', false);

            const [restaurants, movies, tv, games, books] = await Promise.all([
                loadRestaurants().catch(() => []),
                loadMovies().catch(() => []),
                loadTv().catch(() => []),
                loadGames().catch(() => []),
                loadBooks().catch(() => [])
            ]);

            renderRail('restaurantsRail', restaurants, { landscape: true });
            renderRail('moviesRail', movies, { landscape: false });
            renderRail('tvRail', tv, { landscape: false });
            renderRail('gamesRail', games, { landscape: true });
            renderRail('booksRail', books, { landscape: false });

            const loadedCount = [restaurants, movies, tv, games, books].filter(list => list.length > 0).length;
            if (loadedCount === 0) {
                setStatus('Could not load feeds right now. You can still browse each tab directly.', true);
                return;
            }
            setStatus('Universal feed ready.', false);
        }

        initAuthUi();
        initUniversalHome();
    </script>
</body>
</html>
